<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Métodos Cuantitativos - 8&nbsp; Pruebas no paramétricas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-chi-cuadrado.html" rel="next">
<link href="./07-tests-parametricos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pruebas no paramétricas</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Métodos Cuantitativos</a> 
        <div class="sidebar-tools-main">
    <a href="./Métodos-Cuantitativos.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Prefacio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-conceptos-fundamentales.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Conceptos fundamentales</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-distribuciones-de-frecuencias.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Distribuciones de frecuencias</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-tendencia-central-y-variabilidad.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Centralización y dispersión</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-la-distribucion-normal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La distribución normal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-parametros-de-poblacion-y-muestra.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimación de parámetros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-diseno-de-proyecto-y-test-de-hipotesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Diseño de proyectos y test de hipotesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tests-parametricos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pruebas paramétricas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-tests-no-parametricos.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pruebas no paramétricas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-chi-cuadrado.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prueba de <span class="math inline">\(\chi^2\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-correlaciones.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlación</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-referencias.html" class="sidebar-item-text sidebar-link">Referencias</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Apéndices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-valores-criticos-t.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Distribución t</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B-valores-criticos-test-de-signo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Valores críticos del test de signo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C-valores-criticos-ji-cuadrado.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Distribución <span class="math inline">\(\chi^2\)</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice de contenidos</h2>
   
  <ul>
  <li><a href="#sec-prueba-u-de-mann-whitney" id="toc-sec-prueba-u-de-mann-whitney" class="nav-link active" data-scroll-target="#sec-prueba-u-de-mann-whitney"><span class="toc-section-number">8.1</span>  Prueba U de Mann-Whitney</a></li>
  <li><a href="#sec-prueba-de-los-rangos-con-signo-de-wilcoxon" id="toc-sec-prueba-de-los-rangos-con-signo-de-wilcoxon" class="nav-link" data-scroll-target="#sec-prueba-de-los-rangos-con-signo-de-wilcoxon"><span class="toc-section-number">8.2</span>  Prueba de los rangos con signo de Wilcoxon</a>
  <ul class="collapse">
  <li><a href="#y-si-usabamos-la-prueba-t-igual" id="toc-y-si-usabamos-la-prueba-t-igual" class="nav-link" data-scroll-target="#y-si-usabamos-la-prueba-t-igual">¿Y si usabamos la prueba t igual?</a></li>
  </ul></li>
  <li><a href="#sec-prueba-de-signos" id="toc-sec-prueba-de-signos" class="nav-link" data-scroll-target="#sec-prueba-de-signos"><span class="toc-section-number">8.3</span>  Prueba de signos</a></li>
  <li><a href="#realizar-prueba-de-sign-para-n25" id="toc-realizar-prueba-de-sign-para-n25" class="nav-link" data-scroll-target="#realizar-prueba-de-sign-para-n25"><span class="toc-section-number">8.4</span>  Realizar prueba de sign para N&gt;25</a></li>
  <li><a href="#cuál-usar" id="toc-cuál-usar" class="nav-link" data-scroll-target="#cuál-usar"><span class="toc-section-number">8.5</span>  ¿Cuál usar?</a></li>
  <li><a href="#glosario" id="toc-glosario" class="nav-link" data-scroll-target="#glosario"><span class="toc-section-number">8.6</span>  Glosario</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-pruebas-no-parametricas" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Pruebas no paramétricas</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>En el <a href="07-tests-parametricos.html">capítulo&nbsp;<span>7</span></a> vimos que para usar esas pruebas tenemos que cumplir con algunos requisitos sobre la distribución normal de las variables, nivel de medición y homogeneidad de las varianzas. Con alguna frecuencia, sin embargo, resulta que nuestros datos no cumplen con alguno de esos requisitos. Esto se puede dar por la naturaleza de la investigación, por ejemplo si estamos investigando un fenómeno que no se puede medir a escala de intervalo o razón; o tenemos relativamente pocos datos y luego de realizar los test de <em>Fisher</em> y <em>Shapiro</em> nos damos cuenta de que o la varianza es muy heterogénea o que las variables carecen de distribución normal.</p>
<p>Por suerte todavía hay esperanza. Existen algunas pruebas estadísticas, llamadas <em>no paramétricas</em> que nos pueden salvar en estos casos. En este capítulo desarrollaremos tres de ellos.</p>
<section id="sec-prueba-u-de-mann-whitney" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sec-prueba-u-de-mann-whitney"><span class="header-section-number">8.1</span> Prueba U de Mann-Whitney</h2>
<p>La prueba U de Mann-Whitney resulta útil si tenemos dos muestras independientes y queremos si hay una diferencia en la magnitud de la variable que estamos estudiando, pero no podemos usar la prueba de t independiente o la prueba de z porque los datos no cumplen con alguno de los requisitos. Para realizar la prueba U de Mann-Whitney ponemos las observaciones de las dos muestras en orden ascendiente y asignamos un rango ordinal de manera que 1 corresponde a la observación de menor magnitud, 2 a la segunda etcétera. Luego nos fijamos en las diferencias entre las observaciones.</p>
<p>La prueba se basa en una comparación de cada observación de una muestra <span class="math inline">\(x_i\)</span> con cada observación en la segunda muestra <span class="math inline">\(y_j\)</span>. Si las muestras tienen la misma <em>mediana</em>, entones cada observación tiene un 0,5 (50%) de chance de ser mayor o menor que la observación correspondiente de la otra muestra. Por tanto plantea las hipotesis:</p>
<p><span class="math inline">\(H_0: P(x_i&gt;y_j)={1\over2}\)</span></p>
<p><span class="math inline">\(H_1: P(x_i&gt;y_j)\neq{1\over2}\)</span></p>
<p>La prueba U de Mann-Whitney también se conoce con otros nombres: <em>Mann–Whitney–Wilcoxon</em>, <em>Wilcoxon rank-sum test</em> y <em>Wilcoxon–Mann–Whitney</em>. Por ello está disponible en R por medio de la función <code>wilcox.test</code>.</p>
<div id="exm-mann-whitney-u" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 8.1 (Prueba U de Mann-Whitney en R) </strong></span><br>
</p>
<p>En este ejemplo vamos a suponer que tenemos datos diagnósticos de cuatro mujeres y cinco hombres. Todos fueron diagnosticados con diabetes y tenemos la edad a la cual se les descubrió la enfermedad. Queremos saber si hay diferencia en la edad entre hombres y mujeres. Los datos son:</p>
<p>Hombres: {19, 22, 16, 29, 24},<br>
Mujeres: {20, 11, 17, 12}.<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Hombres <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">16</span>, <span class="dv">29</span>, <span class="dv">24</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Mujeres <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">11</span>, <span class="dv">17</span>, <span class="dv">12</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(Hombres, Mujeres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Wilcoxon rank sum exact test
#&gt; 
#&gt; data:  Hombres and Mujeres
#&gt; W = 17, p-value = 0.1111
#&gt; alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Vemos que no podemos rechazar <span class="math inline">\(H_0\)</span> en este caso.</p>
</div>
</section>
<section id="sec-prueba-de-los-rangos-con-signo-de-wilcoxon" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sec-prueba-de-los-rangos-con-signo-de-wilcoxon"><span class="header-section-number">8.2</span> Prueba de los rangos con signo de Wilcoxon</h2>
<p>Vimos en la <a href="#sec-prueba-u-de-mann-whitney">sección&nbsp;<span>8.1</span></a> que la prueba U de Mann-Whitney puede ser una alternativa a la prueba de t de Student para muestras intependiente (véase la <a href="07-tests-parametricos.html#sec-prueba-t-de-student-para-muestras-independientes">sección&nbsp;<span>7.1</span></a>) cuando los requisitos para un test paramétrico no se cumplen. Si los datos son pareados tenemos la <em>prueba de los rangos con signo de Wilcoxon</em> como alternativa a prueba t para muestras pareadas que vimos en la <a href="07-tests-parametricos.html#sec-prueba-t-para-muestras-pareadas">sección&nbsp;<span>7.4</span></a>.</p>
<p>La lógica de la prueba de los rangos con signo de Wilcoxon es similar a la de la prueba de t pareada. Si no hay diferencia en el antes y despues, por ejemplo, las diferencias entre las observaciones deberían tender a cero.</p>
<div id="exm-wilcoxon-sign-test-in-r" class="theorem example">
<p><span class="theorem-title"><strong>Ejemplo 8.2 (Prueba de los rangos con signo de Wilcoxon en R) </strong></span><br>
</p>
<p>En este ejemplo vamos a suponer que tenemos un grupo de doce pacientes con artritis y les damos dos medicaciones distintas para aliviar los síntomas. Pedimos a todos que nos indiquen cuantas horas de alivio observaron con ambas drogas.</p>
<p>Los datos se observan en la <a href="#tbl-drug-comparative-table">tabla&nbsp;<span>8.1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-drug-comparative-table" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabla&nbsp;8.1: Eficiencia de dos medicamentos, reportada por los pacientes.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Paciente</th>
<th style="text-align: right;">Droga.A</th>
<th style="text-align: right;">Droga.B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2,0</td>
<td style="text-align: right;">3,5</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3,6</td>
<td style="text-align: right;">5,7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2,6</td>
<td style="text-align: right;">2,9</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2,7</td>
<td style="text-align: right;">2,4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">7,3</td>
<td style="text-align: right;">9,9</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">3,4</td>
<td style="text-align: right;">3,3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">14,9</td>
<td style="text-align: right;">16,7</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">6,6</td>
<td style="text-align: right;">6,0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">2,3</td>
<td style="text-align: right;">3,8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">2,1</td>
<td style="text-align: right;">4,0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">6,8</td>
<td style="text-align: right;">9,1</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">8,5</td>
<td style="text-align: right;">20,9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>En R ponemos los datos en un <code>data.frame</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paciente =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Droga.A =</span> <span class="fu">c</span>( <span class="dv">2</span>,  <span class="fl">3.6</span>,  <span class="fl">2.6</span>,  <span class="fl">2.7</span>,  <span class="fl">7.3</span>,  <span class="fl">3.4</span>,  <span class="fl">14.9</span>,  <span class="fl">6.6</span>,  <span class="fl">2.3</span>,  <span class="fl">2.1</span>,  <span class="fl">6.8</span>,  <span class="fl">8.5</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Droga.B =</span> <span class="fu">c</span>( <span class="fl">3.5</span>,  <span class="fl">5.7</span>,  <span class="fl">2.9</span>,  <span class="fl">2.4</span>,  <span class="fl">9.9</span>,  <span class="fl">3.3</span>,  <span class="fl">16.7</span>,  <span class="dv">6</span>,  <span class="fl">3.8</span>,  <span class="dv">4</span>,  <span class="fl">9.1</span>,  <span class="fl">20.9</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>E iniciamos nuestros tests:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(datos<span class="sc">$</span>Droga.A,datos<span class="sc">$</span>Droga.B)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  F test to compare two variances
#&gt; 
#&gt; data:  datos$Droga.A and datos$Droga.B
#&gt; F = 0.41865, num df = 11, denom df = 11, p-value =
#&gt; 0.1643
#&gt; alternative hypothesis: true ratio of variances is not equal to 1
#&gt; 95 percent confidence interval:
#&gt;  0.1205199 1.4542635
#&gt; sample estimates:
#&gt; ratio of variances 
#&gt;          0.4186498</code></pre>
</div>
</div>
<p>¡Bien! No tenemos problemas de varianza.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(datos<span class="sc">$</span>Droga.A)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  datos$Droga.A
#&gt; W = 0.80692, p-value = 0.01124</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(datos<span class="sc">$</span>Droga.B)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  datos$Droga.B
#&gt; W = 0.7883, p-value = 0.006919</code></pre>
</div>
</div>
<p>¡Ups!, las variables no tienen distribución normal. Entonces no podemos usar la prueba t pareada, tenemos que probar con <em>Wilcoxon</em>.</p>
<p>Usamos la función <code>wilcox.test</code> con el parametro extra de <code>paired = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(datos<span class="sc">$</span>Droga.A, datos<span class="sc">$</span>Droga.B, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Wilcoxon signed rank test with continuity correction
#&gt; 
#&gt; data:  datos$Droga.A and datos$Droga.B
#&gt; V = 8, p-value = 0.01669
#&gt; alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>Vemos que el valor <em>p</em> se encuentra debajo de nuestro nivel de significanza (<span class="math inline">\(\alpha=0,05\)</span>), con lo cual rechazamos <span class="math inline">\(H_0\)</span> y concluimos que hay una diferencia estadísticamente significativa entre las dos mediamentos.</p>
</div>
<section id="y-si-usabamos-la-prueba-t-igual" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="y-si-usabamos-la-prueba-t-igual">¿Y si usabamos la prueba t igual?</h3>
<p>Si nos hubéramos olvidado de verificar la conformidad de los requisitos podríamos haber caído en la prueba t paramétrica, ¿qué hubiera pasado?</p>
<p>Veamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(datos<span class="sc">$</span>Droga.A, datos<span class="sc">$</span>Droga.B, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Paired t-test
#&gt; 
#&gt; data:  datos$Droga.A and datos$Droga.B
#&gt; t = -2.1465, df = 11, p-value = 0.05498
#&gt; alternative hypothesis: true mean difference is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -4.28706458  0.05373125
#&gt; sample estimates:
#&gt; mean difference 
#&gt;       -2.116667</code></pre>
</div>
</div>
<p>Podemos observar que la prueba de t es sensible a la falta de normalidad en nuestras variables y no logra rechazar <span class="math inline">\(H_0\)</span>.</p>
</section>
</section>
<section id="sec-prueba-de-signos" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="sec-prueba-de-signos"><span class="header-section-number">8.3</span> Prueba de signos</h2>
<p>La prueba de Wilcoxon que vimos en la <a href="#sec-prueba-de-los-rangos-con-signo-de-wilcoxon">sección&nbsp;<span>8.2</span></a> requiere que los datos tengan una escala de medición (véase la <a href="01-conceptos-fundamentales.html#sec-variables-y-su-clasificacion">sección&nbsp;<span>1.5</span></a>) de intervalo. Pero a veces tenemos datos que solo se pueden medir a escala ordinal como por ejemplo la preferencia por alguna bebida de 1 a 5. En este caso no es razonable afirmar que la diferencia entre uno y dos es la misma que entre dos y tres, entonces no podemos tomar en cuenta la magnitud de esas diferencias.</p>
<p>La prueba de signos resuelve este problema convirtiendo la diferencia en una variable trinaria: puede ser cero, positiva o negativa. La lógica del test es similar a la de Wilcoxon, si no hay un patrón en las observaciones estas diferencias deberían tender a cero. Para realizar un test de signo debemos primero anotar el signo (positivo, negativo o cero) de todas los pares de observaciones que tenemos. Cuando la diferencia es cero se excluye el par del análisis y reducimos <em>N</em> acorde a eso. Luego sumamos los positivos por un lado y los negativos por otro y tomamos el <em>menor</em> le los dos. Este número, a menudo significado por una <em>W</em>, de puede compara con la tabla de valores críticos para el N que quedó, que se puede consultar en el <a href="#valores-criticos-del-test-de-signo">apendice B</a> para N entre 5 y 25.</p>
<p>Cuando N es superior a 25, es decir cuando tenemos venticinco o más observaciones que no sean cero, se puede transformar W en una variable normalizada. Usando la fórmula en la <a href="#def-sign-test-large-n">definición&nbsp;<span>8.1</span></a>.</p>
<div id="def-sign-test-large-n" class="theorem definition">
<p><span class="theorem-title"><strong>Definición 8.1 (Normalizar W del test de signos) </strong></span><span class="math display">\[
z={{N-2\times{W}-1}\over\sqrt{N}}
\]</span></p>
</div>
</section>
<section id="realizar-prueba-de-sign-para-n25" class="level2 {exm-realizar-prueba-de-sign}" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="realizar-prueba-de-sign-para-n25"><span class="header-section-number">8.4</span> Realizar prueba de sign para N&gt;25</h2>
<p><br>
</p>
<p>En este ejemplo vamos a suponer que hemos preguntado a 150 personas su opinión sobre el café de dos cafeterías: A y B, de la Ciudad de Buenos Aires. Les pedimos que indiquen en una escala de 1 a 5 cuánto les gusta cada producto. De ellos cincuenta dan el mismo ranking a ambos productos, con lo sus opiniones se eliminan del cálculo. De los restantes cien tenemos 39 que prefieren B y 61 que prefieren A. Tomamos el menor valor (39) y aplicamos la fórmula:</p>
<p><span class="math display">\[
z={{N-2\times{W}-1}\over\sqrt{N}} = {{100-2\times{39}-1}\over\sqrt{100}} = {21\over10} = 2,1
\]</span></p>
<p>Recordamos que el <em>valor mágico</em> de la distribución normal –la regla empírica– es 1,96 para nuestro nivel de significanza <span class="math inline">\((p\leqslant0,05)\)</span> y concluimos que existe una diferencia estadísticamente significativa.</p>
</section>
<section id="cuál-usar" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="cuál-usar"><span class="header-section-number">8.5</span> ¿Cuál usar?</h2>
<p>En la <a href="#fig-selection-non-parametric">figura&nbsp;<span>8.1</span></a> podemos ver un diagrama de flujo para eligir un test no paramétrico.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-selection-non-parametric" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="08-tests-no-parametricos_files/figure-html/fig-selection-non-parametric-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;8.1: Diagrama de flujo para selección de pruebas estadísticas no paramétricas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="glosario" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="glosario"><span class="header-section-number">8.6</span> Glosario</h2>
<dl>
<dt>Prueba de los rangos con signo de Wilcoxon</dt>
<dd>
Prueba estadística. Alternativa a la prueba t pareada, cuando los datos no cumplen con los requisitos para pruebas paramétricas. Función relevante en R: <code>wilcox.test</code>. Equivalente en inglés: «Wilcoxon ranked sign test».
</dd>
<dt>Prueba de signos</dt>
<dd>
Prueba estadística. Alternativa a la prueba t pareada, cuando los datos son de escala ordinal. Equivalente en inglés: «Sign-test».
</dd>
<dt>Prueba U de Mann-Whitney</dt>
<dd>
Prueba estadística. Alternativa a la prueba t o prueba z, cuando los datos no cumplen con los requisitos para pruebas paramétricas. Función relevante en R: <code>wilcox.test</code>. Equivalente en inglés: «Mann-Whitney U test».
</dd>
</dl>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-tests-parametricos.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pruebas paramétricas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-chi-cuadrado.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Prueba de <span class="math inline">\(\chi^2\)</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>